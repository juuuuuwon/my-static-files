
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì›¹ ê¶Œí•œ í…ŒìŠ¤íŠ¸ (/permissions)</title>
<style>
    body {
        font-family: Arial, sans-serif;
        padding: 20px;
        background-color: #f9f9f9;
    }
    .permission-section {
        background: white;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 15px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    h2 {
        margin-top: 0;
        color: #333;
    }
    button {
        padding: 8px 15px;
        font-size: 14px;
        cursor: pointer;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 4px;
        margin-right: 10px;
    }
    button:hover {
        background-color: #0056b3;
    }
    .status {
        margin-top: 10px;
        font-weight: bold;
        color: #555;
    }
    .success { color: green; }
    .failure { color: red; }
    .info { color: orange; }
</style>
</head>
<body>

<h1>ì›¹ ê¶Œí•œ í…ŒìŠ¤íŠ¸ í˜ì´ì§€</h1>

<div class="permission-section">
    <h2>ğŸ“¢ 1. ì•Œë¦¼ (Notification) ê¶Œí•œ</h2>
    <button onclick="testNotificationPermission()">ì•Œë¦¼ ê¶Œí•œ ìš”ì²­ ë° í™•ì¸</button>
    <div id="notificationStatus" class="status">ìƒíƒœ: ëŒ€ê¸° ì¤‘</div>
</div>

<div class="permission-section">
    <h2>ğŸ™ï¸ 2. ë§ˆì´í¬ ë° ì¹´ë©”ë¼ (Media) ê¶Œí•œ</h2>
    <button onclick="testMediaPermission('microphone')">ë§ˆì´í¬ ê¶Œí•œ ìš”ì²­</button>
    <button onclick="testMediaPermission('camera')">ì¹´ë©”ë¼ ê¶Œí•œ ìš”ì²­</button>
    <div id="mediaStatus" class="status">ìƒíƒœ: ëŒ€ê¸° ì¤‘</div>
    <video id="webcamPreview" style="width: 100px; height: 75px; border: 1px solid #ccc; margin-top: 10px; display: none;" autoplay muted></video>
</div>

<div class="permission-section">
    <h2>ğŸ—ºï¸ 3. ìœ„ì¹˜ ì •ë³´ (Geolocation) ê¶Œí•œ</h2>
    <button onclick="testGeolocationPermission()">ìœ„ì¹˜ ì •ë³´ ìš”ì²­</button>
    <div id="geolocationStatus" class="status">ìƒíƒœ: ëŒ€ê¸° ì¤‘</div>
</div>

<div class="permission-section">
    <h2>ğŸ“‹ 4. í´ë¦½ë³´ë“œ ì½ê¸° (Clipboard Read) ê¶Œí•œ</h2>
    <p>(í´ë¦½ë³´ë“œì— í…ìŠ¤íŠ¸ë¥¼ ë³µì‚¬í•œ í›„ ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”)</p>
    <button onclick="testClipboardRead()">í´ë¦½ë³´ë“œ ë‚´ìš© ì¶œë ¥</button>
    <div id="clipboardStatus" class="status">ìƒíƒœ: ëŒ€ê¸° ì¤‘</div>
</div>

<div class="permission-section">
    <h2>ğŸ–¥ï¸ 5. í™”ë©´ ê³µìœ  (Screen Share) ê¶Œí•œ</h2>
    <button onclick="testScreenShare()">í™”ë©´ ê³µìœ  ìš”ì²­</button>
    <div id="screenShareStatus" class="status">ìƒíƒœ: ëŒ€ê¸° ì¤‘</div>
</div>

<script>
    function updateStatus(elementId, message, type = 'info') {
        const element = document.getElementById(elementId);
        element.className = 'status ' + type;
        element.innerText = 'ìƒíƒœ: ' + message;
    }

    function testNotificationPermission() {
        if (!('Notification' in window)) {
            updateStatus('notificationStatus', 'ë¸Œë¼ìš°ì €ê°€ ì•Œë¦¼ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'failure');
            return;
        }
        
        Notification.requestPermission().then(permission => {
            updateStatus('notificationStatus', `ìš”ì²­ ê²°ê³¼: ${permission}`, permission === 'granted' ? 'success' : 'failure');
        });
    }

    async function testMediaPermission(type) {
        const constraints = { video: type === 'camera', audio: type === 'microphone' };
        const statusId = 'mediaStatus';
        const previewElement = document.getElementById('webcamPreview');
        
        if (window.currentStream) {
            window.currentStream.getTracks().forEach(track => track.stop());
            window.currentStream = null;
            previewElement.style.display = 'none';
        }

        if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
            updateStatus(statusId, 'ë¸Œë¼ìš°ì €ê°€ MediaDevicesë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'failure');
            return;
        }

        try {
            updateStatus(statusId, `${type} ê¶Œí•œ ìš”ì²­ ì¤‘...`, 'info');
            const stream = await navigator.mediaDevices.getUserMedia(constraints);
            window.currentStream = stream;
            
            if (type === 'camera') {
                previewElement.srcObject = stream;
                previewElement.style.display = 'block';
            }

            updateStatus(statusId, `${type} ê¶Œí•œ ì„±ê³µ (ì ‘ê·¼ í—ˆìš©ë¨)`, 'success');
        } catch (error) {
            let msg = error.name === 'NotAllowedError' ? 'ê¶Œí•œ ê±°ë¶€ë¨ (NotAllowedError)' : `ì˜¤ë¥˜ ë°œìƒ: ${error.message}`;
            updateStatus(statusId, msg, 'failure');
        }
    }

    function testGeolocationPermission() {
        if (!navigator.geolocation) {
            updateStatus('geolocationStatus', 'ë¸Œë¼ìš°ì €ê°€ ìœ„ì¹˜ ì •ë³´ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'failure');
            return;
        }
        
        updateStatus('geolocationStatus', 'ìœ„ì¹˜ ì •ë³´ ê¶Œí•œ ìš”ì²­ ì¤‘...', 'info');
        navigator.geolocation.getCurrentPosition(
            (position) => {
                updateStatus('geolocationStatus', 'ê¶Œí•œ ì„±ê³µ (ìœ„ì¹˜: ' + position.coords.latitude.toFixed(2) + ', ' + position.coords.longitude.toFixed(2) + ')', 'success');
            },
            (error) => {
                let msg = error.code === error.PERMISSION_DENIED ? 'ê¶Œí•œ ê±°ë¶€ë¨ (PERMISSION_DENIED)' : `ì˜¤ë¥˜ ë°œìƒ: ${error.message}`;
                updateStatus('geolocationStatus', msg, 'failure');
            }
        );
    }

    async function testClipboardRead() {
        if (!navigator.clipboard || !navigator.clipboard.readText) {
            updateStatus('clipboardStatus', 'ë¸Œë¼ìš°ì €ê°€ Async Clipboard APIë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'failure');
            return;
        }
        
        try {
            updateStatus('clipboardStatus', 'í´ë¦½ë³´ë“œ ì½ê¸° ìš”ì²­ ì¤‘...', 'info');
            const text = await navigator.clipboard.readText();
            updateStatus('clipboardStatus', `ì„±ê³µ, ë‚´ìš©: "${text.substring(0, 30)}${text.length > 30 ? '...' : ''}"`, 'success');
        } catch (error) {
            let msg = error.name === 'NotAllowedError' ? 'ê¶Œí•œ ê±°ë¶€ë¨ (HTTPS ë° ê¶Œí•œ í™•ì¸ í•„ìš”)' : `ì˜¤ë¥˜ ë°œìƒ: ${error.message}`;
            updateStatus('clipboardStatus', msg, 'failure');
        }
    }
    
    async function testScreenShare() {
            if (!navigator.mediaDevices || !navigator.mediaDevices.getDisplayMedia) {
            updateStatus('screenShareStatus', 'ë¸Œë¼ìš°ì €ê°€ Screen Capture APIë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'failure');
            return;
        }
        
        try {
            updateStatus('screenShareStatus', 'í™”ë©´ ê³µìœ  ê¶Œí•œ ìš”ì²­ ì¤‘...', 'info');
            const stream = await navigator.mediaDevices.getDisplayMedia({ video: true });
            stream.getTracks().forEach(track => track.stop());
            
            updateStatus('screenShareStatus', 'ê¶Œí•œ ì„±ê³µ (í™”ë©´ ê³µìœ  ìš”ì²­ ì°½ì´ ë‚˜íƒ€ë‚¬ìŠµë‹ˆë‹¤)', 'success');
        } catch (error) {
            let msg = error.name === 'NotAllowedError' ? 'ì‚¬ìš©ì ë˜ëŠ” ì‹œìŠ¤í…œì—ì„œ ê±°ë¶€ë¨' : `ì˜¤ë¥˜ ë°œìƒ: ${error.message}`;
            updateStatus('screenShareStatus', msg, 'failure');
        }
    }
</script>

</body>
</html>